{% extends 'base.html' %} {% block title %}
<title>详情页</title>
{% endblock %} {% block css %} {% load static %}
<link rel="stylesheet" href="{% static 'css/details.css' %}"> {% endblock %} {% block main %}
<div>

    <!--文章开始-->
    <div class="jumbotron jumbotron-ad hidden-print">
        <div class="container">
            <h1> {{article.title}} </h1>
            <p> {{article.user.name}} </p>
            <p>
                <span> {{article.time}}</span>
                <span class="badge badge-light">{{article.category.name}}</span>
            </p>
        </div>
    </div>
    <div class="content-underlay"></div>
    <div class="container">
        <article class="page-content"> {{ article.content | safe }}</article>
    </div>

    <div class="hr margin-top-xl"></div>

    <!--文章结束-->
    <div class="container">

        {% if user == article.author %}
        <!-- 删除文章 -->
        <form action="{% url 'article-delete' article.id %}" method="post">
            {% csrf_token %}
            <input type="submit" value="删除文章">
        </form>

        <!-- 编辑文章 -->
        <a href="{% url 'article-update' article.id %}">编辑文章</a>
        {% endif %}

        <!--留言开始-->
        {% if user %}
        <form action="{% url 'article-detail' article.id %}" method="POST">
            {% csrf_token %}
            {{ form.as_p }}
            <input type="submit" value="提交留言" />
        </form>
        {% else %}
        <p> 您还没有登录，请登录后再留言。</p>
        {% endif %}
    </div>

    <div class="container">
        <div class="container">
            <div class="top">
                <span>全部留言</span>
                <span class="number">{{ comments | length }}</span>
            </div>
            <div class="bottom">
                {% for i in comments %}
                <div class="box">
                    <div class="left">
                        <img src="/media/{{i.img}}" alt="">
                    </div>
                    <div class="right">
                        <div class="right_top">
                            <span>{{i.user}}</span>
                            <span>{{i.time}}</span>
                            {% if user == i.author %}
                            <form action="{% url 'comment-delete' i.id %}" method="POST">
                                {% csrf_token %}
                                <input type="submit" value="删除留言">
                                {% endif %}
                            </form>
                        </div>
                        <div class="right_bottom">
                            <p>{{i.content}}</p>
                        </div>
                    </div>
                </div>
                {% endfor %}

            </div>
        </div>
    </div>
</div>
</div>
<!--留言结束-->

{% endblock %}